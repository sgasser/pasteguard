---
title: Secrets Detection
description: Detect and protect private keys, API keys, and tokens
---

# Secrets Detection

PasteGuard detects secrets before PII detection and can block, redact, or route requests containing sensitive credentials.

## Supported Secret Types

### Private Keys (enabled by default)

| Type | Pattern |
|------|---------|
| `OPENSSH_PRIVATE_KEY` | `-----BEGIN OPENSSH PRIVATE KEY-----` |
| `PEM_PRIVATE_KEY` | `-----BEGIN RSA PRIVATE KEY-----`, etc. |

### API Keys (opt-in)

| Type | Pattern |
|------|---------|
| `API_KEY_OPENAI` | `sk-...` (48+ chars) |
| `API_KEY_AWS` | `AKIA...` (20 chars) |
| `API_KEY_GITHUB` | `ghp_...`, `gho_...`, `ghu_...`, `ghs_...`, `ghr_...` (40+ chars) |

### Tokens (opt-in)

| Type | Pattern |
|------|---------|
| `JWT_TOKEN` | `eyJ...` (three base64 segments) |
| `BEARER_TOKEN` | `Bearer ...` (40+ char tokens) |

## Actions

| Action | Description |
|--------|-------------|
| `block` | Return HTTP 400, request never reaches LLM (default) |
| `redact` | Replace secrets with placeholders, restore in response |
| `route_local` | Route to local LLM (requires route mode) |

### Block (Default)

```yaml
secrets_detection:
  enabled: true
  action: block
```

Request is rejected with HTTP 400. The secret never reaches the LLM.

### Redact

```yaml
secrets_detection:
  action: redact
```

Secrets are replaced with placeholders and restored in the response (like PII masking).

### Route to Local

```yaml
mode: route
secrets_detection:
  action: route_local
```

Requests with secrets are sent to your local LLM instead.

## Response Headers

When secrets are detected:

```
X-PasteGuard-Secrets-Detected: true
X-PasteGuard-Secrets-Types: OPENSSH_PRIVATE_KEY,API_KEY_OPENAI
```

If secrets were redacted:

```
X-PasteGuard-Secrets-Redacted: true
```
